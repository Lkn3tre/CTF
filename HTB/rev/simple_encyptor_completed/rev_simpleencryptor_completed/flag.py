import random
l = ['2014390344', '1469870660', '1982650619', '1625766133', '692418227', '51836669', '1207566194', '29148633', '1814471238', '927732162', '1046980137', '565814735', '422047055', '1517221094', '1814698569', '753299776', '2030934960', '1040711614', '1195375342', '920661508', '574642855', '351439671', '1713504022', '1635586270', '1468557073', '920046345', '1005726139', '1081414708', '653914299', '1269692214', '1744271893', '520820995', '592079226', '1579438864', '2146587128', '1284497453', '1631275533', '1206669674', '1313646087', '1298263123', '2134401837', '213142576', '1864077858', '408965244', '1730363670', '1531292779', '1162265020', '1613814982', '424520745', '210156714', '386992843', '999163600', '561596385', '2100496865', '487266223', '2030153458', '873059562', '1694556044']
listr1 = [l[i] for i in range(0,len(l),2)]
listr2 = [l[i+1] for i in range(0,len(l)-1,2)]

def get_char(x):
    if x < 128:
        return x
    else:
        y = bin(x)[len(bin(x))-8:]
        return int(y,2)    

with open("flag.enc", "rb") as f:
    content = f.read()    

a = bytearray(content)

for i in range(len(a[4:])):
    r1 = get_char(int(listr1[i]))
    r2 = get_char(int(listr2[i]))
    for j in range(33,127):
        c = j ^ r1 
        d = r2 & 7
        c = get_char(c)
        c =  get_char(c << d ) | get_char(c >> (8-d))
        c= get_char(c)
        

        
        if(c == a[i+4]):

            print(chr(j),end="")
            break
    